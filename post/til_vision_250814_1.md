---
title: "이미지 인식을 위한 합성곱 신경망 (CNN)"
date: "2025-08-14"
keywords: ["TIL", "CNN", "컴퓨터 비전"]
---

# 이미지 인식을 위한 합성곱 신경망 (CNN)

## CNN의 핵심: 지역 특징(Local Feature) 추출

- **등장 배경**: 일반적인 심층 신경망(DNN)에 이미지를 입력으로 넣으면, 2D 이미지 데이터를 1D 벡터로 변환해야 하므로 이미지의 중요한 **공간적/지역적 특징(spatial/local feature)**이 손실됩니다. 또한, 이미지의 각 픽셀을 입력 뉴런으로 사용하면 가중치의 수가 너무 많아져 학습이 비효율적입니다.
- **CNN의 아이디어**: 인간의 시신경이 이미지 전체를 한 번에 보지 않고, 특정 부분에 집중하여 특징을 파악한 후 종합하는 방식에서 영감을 얻었습니다. 이미지의 전체가 아닌 **일부분(local receptive field)**에만 연결된 뉴런들을 사용하여 지역 특징(모서리, 질감 등)을 먼저 추출하고, 이들을 조합하여 더 고차원적인 특징(눈, 코, 입)을 만들어나갑니다.

## CNN의 기본 구조

CNN은 크게 **특징 추출 부분(Feature Extraction)**과 **분류 부분(Classification)**으로 나뉩니다.

1.  **특징 추출 (Feature Extraction)**: **합성곱 층(Convolutional Layer)**과 **풀링 층(Pooling Layer)**을 여러 겹 쌓아 이미지의 주요 특징을 추출하고 압축합니다.
2.  **분류 (Classification)**: 추출된 특징 맵(Feature Map)을 1차원 벡터로 만든 후, **완전 연결 층(Fully-Connected Layer)**에 연결하여 이미지를 최종적으로 분류합니다.

### 1. 합성곱 층 (Convolutional Layer)

- **필터 (Filter) / 커널 (Kernel)**: 이미지의 특징을 찾아내기 위한 공용 **가중치 마스크**입니다. 이 필터가 이미지 위를 이동(slide)하면서, 필터와 겹쳐지는 이미지 부분의 각 픽셀 값과 필터의 가중치를 곱한 후 모두 더하는 **합성곱(Convolution)** 연산을 수행합니다. 이 결과로 나온 하나의 값을 **특징 맵(Feature Map)**의 한 픽셀로 사용합니다.
- **핵심 원리**: 하나의 필터는 이미지 전체에서 **동일한 하나의 특징**(예: 수직선)을 감지하는 역할을 합니다. 여러 개의 필터를 사용하면 다양한 관점의 특징들을 동시에 추출할 수 있습니다.
- **주요 하이퍼파라미터**:
  - **스트라이드 (Stride)**: 필터가 한 번에 이동하는 칸의 크기입니다. 스트라이드가 크면 특징 맵의 크기는 작아집니다.
  - **패딩 (Padding)**: 합성곱 연산 시 이미지의 가장자리에 특정 값(주로 0)을 채워 넣는 것입니다. 패딩을 사용하면 이미지의 외곽 정보 손실을 막고, 출력되는 특징 맵의 크기를 조절할 수 있습니다. (e.g., **Same Padding**: 입력과 출력의 가로, 세로 크기를 동일하게 유지)

### 2. 풀링 층 (Pooling Layer)

- **개념**: 합성곱 층을 통해 얻은 특징 맵의 크기를 줄이는 **서브샘플링(Sub-sampling)** 과정입니다. 계산량을 줄이고, 약간의 위치 변화에도 동일한 특징을 잡아낼 수 있도록(translation invariance) 도와 과적합을 방지합니다.
- **종류**:
  - **최대 풀링 (Max Pooling)**: 특정 구역(예: 2x2)에서 가장 큰 값(가장 활성화된 특징)만 남깁니다. 일반적으로 가장 많이 사용됩니다.
  - **평균 풀링 (Average Pooling)**: 특정 구역의 값들의 평균을 취합니다.
- **특징**: 풀링 층은 학습해야 할 가중치가 없으며, 채널(channel)의 수는 변경하지 않고 높이와 너비만 줄입니다.

### 3. 완전 연결 층 (Fully-Connected Layer)

- **역할**: 특징 추출 부분을 통해 얻은 다차원 특징 맵을 1차원 벡터로 펼친(Flatten) 후, 이를 입력으로 받아 최종적으로 이미지를 분류하거나 회귀 예측을 수행합니다. 일반적인 다층 퍼셉트론(MLP)과 동일한 구조입니다.
