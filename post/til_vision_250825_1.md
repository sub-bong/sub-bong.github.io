---
title: "픽셀 단위의 이해, 의미 분할(Semantic Segmentation)"
date: "2025-08-25"
keywords: ["TIL", "컴퓨터 비전", "의미 분할"]
---

# 픽셀 단위의 이해, 의미 분할(Semantic Segmentation)

## 의미 분할이란?

- **개념**: 이미지 내의 모든 픽셀에 대해, 해당 픽셀이 어떤 클래스(예: 하늘, 나무, 사람, 도로)에 속하는지를 예측하는 과제입니다. 같은 클래스의 객체는 구분하지 않고 모두 동일한 클래스로 취급합니다.
- **목표**: 이미지 전체를 픽셀 단위로 조밀하게(dense) 분류하여, 객체의 정확한 모양과 영역을 이해하는 것입니다.

## 전통적인 분할 방법의 한계

- **GrabCut, 정규화 절단(Normalized Cut) 등**: 과거의 알고리즘들은 색상, 질감, 경계선 등의 저수준(low-level) 특징을 기반으로 이미지를 여러 영역으로 나누는 데 중점을 두었습니다.
- **한계**: 이 방법들은 분할된 영역이 **무엇을 의미하는지(semantic)** 알지 못합니다. 예를 들어, 특정 영역을 '자동차'라고 인식하는 것이 아니라, 단순히 '파란색 덩어리'로만 구분할 뿐입니다.

## 딥러닝 기반 분할 모델

딥러닝의 등장은 의미 분할 분야에 혁신을 가져왔습니다. 특히 **인코더-디코더(Encoder-Decoder)** 구조가 핵심적인 역할을 합니다.

### 1. FCN (Fully Convolutional Network)

- **의의**: 의미 분할을 위해 **완전 합성곱 네트워크(FCN)**를 제안한 선구적인 모델입니다.
- **핵심 아이디어**: 기존의 이미지 분류용 CNN 모델(예: VGGNet)에서 분류를 위해 사용되던 **완전 연결 층(Fully-Connected Layer)을 모두 합성곱 층(Convolutional Layer)으로 대체**했습니다.
- **원리**:
  1.  **인코더(Encoder)**: 일반적인 CNN과 같이 합성곱과 풀링을 반복하며 이미지의 차원을 줄여나가고, 문맥 정보를 압축하여 특징을 추출합니다.
  2.  **디코더(Decoder)**: 압축된 특징 맵을 다시 원래 이미지 크기로 확대(**업샘플링, Up-sampling**)하여 픽셀 단위의 예측을 수행합니다.
- **한계**: 인코더 과정에서 풀링으로 인해 손실된 상세한 위치 정보를 디코더가 완전히 복원하기 어려워, 분할 경계가 다소 뭉개지는 경향이 있습니다.

### 2. U-Net

- **개발**: 의료 영상(특히 세포) 분할을 위해 개발되었으며, 현재 다양한 분할 문제의 표준 모델 중 하나로 자리 잡았습니다.
- **핵심 아이디어**: FCN의 한계를 극복하기 위해, 인코더와 디코더를 대칭적인 U자 형태로 만들고 그 사이에 **스킵 커넥션(Skip Connection)**을 추가했습니다.
- **구조**:
  1.  **인코더 (수축 경로, Contracting Path)**: 이미지를 입력받아 합성곱과 풀링을 통해 특징을 추출하고 차원을 축소합니다. (전체적인 문맥 정보 포착)
  2.  **디코더 (확장 경로, Expansive Path)**: 업샘플링을 통해 특징 맵의 차원을 점차 확대하여 상세한 분할 맵을 생성합니다.
  3.  **스킵 커넥션 (Skip Connection)**: 디코더의 각 단계에서, 같은 레벨의 **인코더 특징 맵을 디코더 특징 맵에 직접 연결(concatenate)**해줍니다.
- **장점**: 스킵 커넥션을 통해, 인코더의 풀링 과정에서 손실될 수 있는 **저수준(low-level)의 정확한 위치 정보**가 디코더에 그대로 전달됩니다. 이를 통해 U-Net은 전체적인 문맥 정보와 상세한 위치 정보를 모두 활용하여, 매우 정교하고 깔끔한 경계선을 가진 분할 결과를 만들어낼 수 있습니다.
